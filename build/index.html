<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>INSEEC 2017</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://rue-de-la-vieille.fr'>Me contacter</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="javascript">JavaScript</h1>

<h2 id="introduction">Introduction</h2>

<p>JavaScript est différent de Java. Attention, pour abréger JavaScript, utiliser « js », pas « java ».
Les informations qui suivent sont toutes relative à JavaScript dans un environnement bien particulier :
le navigateur web. Pour des informations sur JavaScript dans d’autres contextes
voir <a href="https://nodejs.org/en/">NodeJS</a>.</p>

<p>Dans une page web, le balisage est censé servir le <em>sens</em>, la <em>sémantique</em> : structurer le contenu.
Un paragraphe, une liste, un lien, une section, un entête, etc. Les feuilles de styles en
cascade (Cascading Style Sheets / CSS) définissent l’<em>apparence</em> de ce contenu et,
dans une certaine mesure, son comportement. La mise en page, la police de caractère, les couleurs,
tout ça relève des CSS. L’apparence des différents éléments du contenu au survol du curseur,
ou lorsqu’ils recoivent le focus, ou lorsqu’ils sont activés par un clic, tout ça relève aussi
des CSS.</p>

<p>JavaScript vient ajouter une gestion plus complète et complexe de <em>comportement</em> et
d’<em>interactivité</em> à la page. On tâchera de ne pas traiter les questions d’apparence et de
cantonner JavaScript à des changements d’état, par exemple changements de classe sur les
élément de la page, et on laissera aux CSS la possibilité d’y réagir ou non.</p>

<h2 id="recommandations">Recommandations</h2>

<p>Pour travailler efficacement, pour progresser plus rapidement et s’éviter des souffrances
inutiles :</p>

<ul>
<li>Faire afficher les extensions de fichiers dans l’explorateur de fichiers, quel qu’il soit
(<em>Options des dossiers</em> sous Windows, <em>Préférences du Finder</em> sous MacOS).</li>
<li>Isoler les exercices dans un dossier spécifique et travailler dans un seul dossier à la fois.</li>
<li>Travailler avec l’inspecteur Web ouvert.</li>
<li>Vérifier la console à chaque changement.</li>
<li>Désactiver le cache.</li>
</ul>

<h2 id="insérer-du-javascript">Insérer du JavaScript</h2>

<blockquote>
<p>JavaScript en ligne</p>
</blockquote>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s1">'Hello INSEEC!'</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>

<p>Pour insérer du JavaScript directement dans une page, on utilise la balise script.
Le JavaScript est inséré entre deux balises, <code class="prettyprint">&lt;script&gt;</code> et <code class="prettyprint">&lt;/script&gt;</code>.</p>

<p>Ça s’appelle <em>JavaScript en ligne</em> ou <em>inlined JS</em>. Cette façon de procéder possède
des inconvénients. Si le même script est utilisé sur toutes les pages du site 
(ce qui est extrêmement fréquent), il est rechargé par le réseau à chaque chargement de page,
ce qui implique la latence d’une requête supplémentaire et de la bande passante.</p>

<blockquote>
<p>JavaScript externalisé dans le fichier <code class="prettyprint">index.js</code></p>
</blockquote>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"index.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>

<p>Alors on préférera insérer du JavaScript en pointant vers un fichier externe.</p>

<p>De cette façon il peut-être mis en cache par le navigateur et n’être chargé
qu’une seule fois pour tout le site.</p>

<h2 id="exercices">Exercices</h2>

<h3 id="base">Base</h3>
<pre class="highlight html"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"fr-FR"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;title&gt;</span>JavaScript<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"css/main.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;header&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Base JavaScript<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"navToggle"</span><span class="nt">&gt;</span>
        Menu
    <span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/header&gt;</span>
<span class="nt">&lt;main&gt;</span>
    <span class="nt">&lt;p&gt;</span>
        Vivamus at pharetra diam…
    <span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;</span>
        Aliquam turpis arcu, aliquam ac venenatis…
    <span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/main&gt;</span>
<span class="nt">&lt;nav&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
        <span class="nt">&lt;li&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Accueil<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>À propos<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Portfolio<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Contact<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>

<p>Les exercices sont basés sur ce HTML.</p>

<h3 id="exercice-1">Exercice 1</h3>
<pre class="highlight javascript"><code><span class="nx">alert</span><span class="p">(</span><span class="s1">'Hello INSEEC!'</span><span class="p">);</span>
</code></pre>

<p>La fonction <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/alert"><code class="prettyprint">alert</code></a>
permet de créer une boîte de dialogue.
Pour appeler une fonction on ajoute les parenthèses à son nom.
Les paramètres d’une fonction sont placés entre ces parenthèses, et séparés par des virgules.
Ici, la fonction <code class="prettyprint">alert</code> prend une chaîne de caractère en paramètre
(du texte entre guillemets).</p>

<blockquote>
<p>Créer une fonction personnalisée :</p>
</blockquote>
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">doSomething</span><span class="p">(</span><span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Ici on fait quelque chose, par exemple…</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<blockquote>
<p>Et l’appeler :</p>
</blockquote>
<pre class="highlight javascript"><code><span class="nx">doSomething</span><span class="p">();</span>
</code></pre>

<p>La fonction <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/alert"><code class="prettyprint">alert</code></a>
est pré-définie par le navigateur. Mais on peut définir nos propres fonctions.</p>

<div style="clear:both"></div>

<blockquote>
<p>Commentaires :</p>
</blockquote>
<pre class="highlight javascript"><code><span class="c1">// Ça, c’est un commentaire, sur une ligne</span>

<span class="cm">/* Et ça aussi,
   mais attention à bien le refermer */</span>
</code></pre>

<p>Il est possible d’ajouter des commentaires en JavaScript.</p>

<h3 id="exercice-2">Exercice 2</h3>
<pre class="highlight javascript"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Hello INSEEC!'</span><span class="p">);</span>
</code></pre>

<p>Pour afficher un message dans la console de l’inspecteur Web on utilise
l’objet <code class="prettyprint">console</code> mis à disposition par le navigateur, et on appelle sa 
<em>méthode</em> <code class="prettyprint">log</code> qui accepte un ou plusieurs paramètres. Une <em>méthode</em>
est une fonction spécifique à un objet. On accède aux méthodes d’un
objet grâce à l’opérateur <code class="prettyprint">.</code></p>

<p>Pour plus d’informations sur cette méthode, voir la
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Console/log"><code class="prettyprint">documentation</code></a></p>

<h3 id="exercice-3">Exercice 3</h3>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">choix</span> <span class="o">=</span> <span class="nx">confirm</span><span class="p">(</span><span class="s1">'Afficher un message ?'</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">choix</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'En v’la un message !'</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p>Utiliser un dialogue de confirmation et n’afficher un message dans la console<br>
que si l’utilisateur clique sur OK.</p>

<p><code class="prettyprint">var</code> est un mot clé JS.<br>
<code class="prettyprint">choix</code> est le nom de la variable (une boîte).<br>
La fonction <code class="prettyprint">confirm</code> retourne vrai ou faux.<br>
<code class="prettyprint">if</code> est une structure de contrôle.</p>

<div style="clear:both"></div>
<pre class="highlight javascript"><code><span class="k">if</span> <span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Ce block est exécuté si test est vrai</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Ce block est exécuté si test est faux</span>
<span class="p">}</span>
</code></pre>

<p>Un bloc de code est contenu entre des accolades.</p>

<h3 id="exercice-4">Exercice 4</h3>

<p>Voir <a href="#inserer-du-javascript">Insérer du JavaScript</a>.</p>

<h3 id="exercice-5">Exercice 5</h3>
<pre class="highlight javascript"><code><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">;</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p>Créer une boucle <code class="prettyprint">for</code> pour afficher les nombres de 1 à 1000.</p>

<p>Une boucle <code class="prettyprint">for</code> est composée de trois expressions :</p>

<ul>
<li>Initialisation</li>
<li>Condition</li>
<li>Incrémentation</li>
</ul>

<p><code class="prettyprint">for</code> est une autre structure de contrôle de JavaScript.</p>

<div style="clear:both"></div>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
    <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<p>La boucle <code class="prettyprint">while</code> est une autre façon de faire des boucles en JavaScript,
une autre structure de contrôle. Elle s’utilise différemment et répond à
d’autres cas.</p>

<p>À droite l’équivalent de l’exercice 5 réalisé avec une boucle <code class="prettyprint">while</code>. </p>

<h3 id="exercice-6">Exercice 6</h3>
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">fib</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">max</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">fib</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fib</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nx">fib</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">fib</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">resultat</span> <span class="o">=</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">resultat</span><span class="p">);</span>
</code></pre>

<p>Écrire dans la console les 20 premiers nombres de la suite de Fibonacci.</p>

<p><code class="prettyprint">fib</code> est un tableau. L’index des tableaux commence à 0.<br>
<code class="prettyprint">fib[0]</code> pour accéder au premier élément.<br>
<code class="prettyprint">return</code> pour renvoyer la valeur.</p>

<blockquote>
<p>Approximation du nombre d’or</p>
</blockquote>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">fib</span> <span class="o">=</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Phi ~ '</span><span class="o">+</span> <span class="p">(</span><span class="nx">fib</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">/</span> <span class="nx">fib</span><span class="p">[</span><span class="mi">18</span><span class="p">]));</span>
</code></pre>

<p>À noter que les nombres de la suite de Fibonacci permettent d’approcher le
<a href="https://en.wikipedia.org/wiki/Golden_ratio#Relationship_to_Fibonacci_sequence">nombre d’or</a>
lorsqu’on divise le nombre obtenu au rang n par le nombre obtenu au rang n-1.</p>

<h3 id="exercice-7">Exercice 7</h3>
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">showMessage</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Bouton cliqué !'</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">button</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.navToggle'</span><span class="p">);</span>
<span class="nx">button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">showMessage</span><span class="p">);</span>
</code></pre>

<p>Afficher un message dans la console lorsque l’utilisateur clique sur le bouton « Menu ».</p>

<p><code class="prettyprint">document</code> est l’élément racine de la page, fourni par le navigateur.<br>
<code class="prettyprint">querySelector</code> est une méthode de <code class="prettyprint">document</code> qui prend un sélecteur CSS en paramètre.<br>
<code class="prettyprint">addEventListener</code>  est une méthode de l’élément <code class="prettyprint">button</code>.<br>
Au clic, on exécute la fonction <code class="prettyprint">showMessage</code>.</p>

<div style="clear:both"></div>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">button</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.navToggle'</span><span class="p">);</span>
<span class="nx">button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Bouton cliqué !'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<p>Cet exemple pourrait aussi s’écrire avec une fonction anonyme ou
<em>closure</em>. Dans ce cas on passe non plus le nom de la fonction en paramètre
mais directement la fonction elle-même.</p>

<h3 id="exercice-8">Exercice 8</h3>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">button</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.navToggle'</span><span class="p">);</span>
<span class="nx">button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>
    <span class="nx">body</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="s1">'nav-on'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<p>Lorsque l’utilisateur clique sur le bouton « Menu »,
ajouter une classe « nav-on » à l’élément body.</p>

<p><code class="prettyprint">classList</code> est une propriété de l’élément <code class="prettyprint">body</code>.<br>
<code class="prettyprint">toggle()</code> est une méthode de la propriété <code class="prettyprint">classList</code>.<br>
On accède à la propriété d’un objet grâce à l’opérateur <code class="prettyprint">.</code><br>
<code class="prettyprint">toggle()</code> ajoute ou retire la classe selon qu’elle est présente ou pas.</p>

<h3 id="exercice-9">Exercice 9</h3>
<pre class="highlight css"><code><span class="nt">nav</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">body</span><span class="nc">.nav-on</span> <span class="nt">nav</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<p>Masquage et affichage du menu.</p>

<p>On ne gère que l’interactivité (événement click) en JavaScript.
Le changement d’affichage est laissé à CSS grâce à la modification d’une classe.
Le menu est masque par défaut avec <code class="prettyprint">display: none</code> et affiché lorsque
l’élément <code class="prettyprint">body</code> possède la classe <code class="prettyprint">nav-on</code>.</p>

<p>Le code JavaScript ne change pas par rapport à l’exercice 8.</p>

<h3 id="exercice-10">Exercice 10</h3>
<pre class="highlight css"><code><span class="nt">nav</span> <span class="p">{</span>
    <span class="nl">background</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">1em</span> <span class="m">2em</span><span class="p">;</span>
    <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
    <span class="nl">right</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<p>À ce stade, il est possible d’afficher / masquer la navigation en cliquant sur le bouton menu.
C’est bien, mais c’est moche. On voudrait plutôt que le menu :</p>

<ul>
<li>Apparaisse en blanc sur noir semi transparent</li>
<li>Apparaisse tout contre le bord droit de la page</li>
<li>Prenne toute la hauteur de la page</li>
</ul>

<h3 id="exercice-11">Exercice 11</h3>
<pre class="highlight css"><code><span class="nt">nav</span> <span class="p">{</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
    <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
    <span class="nl">right</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">top</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">transform</span><span class="p">:</span> <span class="n">translateX</span><span class="p">(</span><span class="m">-100%</span><span class="p">);</span>
    <span class="nl">transition</span><span class="p">:</span> <span class="n">transform</span> <span class="m">300ms</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">body</span><span class="nc">.nav-on</span> <span class="nt">nav</span> <span class="p">{</span>
    <span class="nl">transform</span><span class="p">:</span> <span class="n">translateX</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p>Au lieu d’afficher et masquer le menu avec <code class="prettyprint">visibility: hidden</code>
ou <code class="prettyprint">display: none</code>, on le pousse hors écran avec <code class="prettyprint">transform: translateX(100%)</code>.</p>

<p>Ici la valeur <code class="prettyprint">100%</code> s’exprime en fonction de la largeur de l’élément.
Il est donc décalé de 100% de sa largeur vers la droite. Lorsque
l’élément <code class="prettyprint">body</code> possède la classe <code class="prettyprint">nav-on</code>, alors on annule le
décalage en le repassant à 0 et le menu apparaît.</p>

<p>La propriété CSS <code class="prettyprint">transition</code> est ensuite utilisée pour demander au navigateur
d’animer la propriété <code class="prettyprint">transform</code> lorsque sa valeur change. On indique
la propriété, <code class="prettyprint">transform</code>, que l’on souhaite animer suivie de la durée de
l’animation, ici <code class="prettyprint">300ms</code> pour 300 millisecondes. Il est possible d’exprimer
cette durée en secondes, par exemple <code class="prettyprint">2s</code>.</p>

<p>Pour animer plusieurs propriétés, il faut les séparer par des virgules,
par exemple <code class="prettyprint">transform: opacity 200ms, scale 100ms;</code>.</p>

<p>À noter que pour des raisons de performances, on tâchera autant que possible
d’animer uniquement les propriétés <code class="prettyprint">transform</code> et <code class="prettyprint">opacity</code>. Ces deux
propriétés CSS sont les plus rapides à calculer pour le navigateur.</p>

<h3 id="exercice-12">Exercice 12</h3>
<pre class="highlight html"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"mailto:jerome@rue-de-la-vieille.fr"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"form_nom"</span><span class="nt">&gt;</span>Nom<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"nom"</span> <span class="na">id=</span><span class="s">"form_nom"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"form_email"</span><span class="nt">&gt;</span>Email<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"email"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">id=</span><span class="s">"form_email"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"form_message"</span><span class="nt">&gt;</span>Message<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;textarea</span> <span class="na">name=</span><span class="s">"message"</span> <span class="na">id=</span><span class="s">"form_message"</span><span class="nt">&gt;&lt;/textarea&gt;</span>
    <span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;</span>
        <span class="nt">&lt;button&gt;</span>Envoyer<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>

<p>Créer un formulaire de contact avec les champs suivants :</p>

<ul>
<li>Nom (champ texte)</li>
<li>Email (champ email)</li>
<li>Message (champ texte long)</li>
</ul>

<p>Le formulaire doit être soumis par email
(il sera modifié au moment du cours PHP pour être envoyé au serveur, peut-être).</p>

<h3 id="exercice-13">Exercice 13</h3>
<pre class="highlight javascript"><code><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'form'</span><span class="p">);</span>
    <span class="nx">form</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'submit'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'nom'</span><span class="p">,</span> <span class="s1">'email'</span><span class="p">,</span> <span class="s1">'message'</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">fields</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">field</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'[name="'</span><span class="o">+</span> <span class="nx">fields</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span><span class="s1">'"]'</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
                <span class="nx">alert</span><span class="p">(</span><span class="s1">'Le champ '</span><span class="o">+</span> <span class="nx">fields</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span><span class="s1">' est obligatoire'</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">})();</span>
</code></pre>

<p>Écouter la soumission du formulaire et la bloquer si un des champs n’est pas renseigné.</p>

<p>On récupère l’élément <code class="prettyprint">form</code> et on place un écouteur dessus, pour l’événement <code class="prettyprint">submit</code>.
On n’écoute pas l’événement <code class="prettyprint">clic</code> du bouton de soumission parce que le formulaire
peut-être soumis par d’autres moyens, notamment une validation dans un des champs text
(appui sur la touche <code class="prettyprint">[ENTER]</code> lorsqu’un des champs texte a le <em>focus</em>).</p>

<p>Lorsque le formulaire est soumis, on teste les champs un par un. Puisque le traitement
est identique pour chaque champ, on a recourt à une boucle pour ne coder le travail
qu’une seule fois :</p>

<ul>
<li>Récupération du champ à partir de son nom</li>
<li>Test de la valeur saisie (<code class="prettyprint">field.value === &#39;&#39;</code>)</li>
<li>Annulation de la soumission si le champ est vide, affichage d’une erreur et sortie de la boucle</li>
</ul>

<h1 id="wordpress">WordPress</h1>

<h2 id="création-des-événements">Création des événements</h2>

<p>Le site Siècle Digital présente une liste d’événements.
Ces événements ne sont ni <em>post</em> ni <em>page</em>, ce sont des contenus personnalisés. WordPress permet
de déclarer et d’administrer facilement des <em>types de contenus personnalisés</em> ou 
<a href="https://codex.wordpress.org/Post_Types"><code class="prettyprint">Custom Post Type</code></a>.</p>

<p>Pour ajouter la gestion des événements voulue on va donc :</p>

<ol>
<li>Créer un nouveau type de post pour nos événements</li>
<li>Ajouter au menu le lien vers la liste de nos événements</li>
<li>Créer des templates qui permettront de personnaliser l’affichage (le balisage) des événements</li>
<li>Personnaliser les styles associés à ces templates pour nous rapprocher de l’affichage de
<a href="https://siecledigital.fr/evenements/">Siècle Digital</a></li>
</ol>

<h3 id="création-d’un-custom-post-type">Création d’un Custom Post Type</h3>

<blockquote>
<p>Dans <code class="prettyprint">wp-content/mu-plugins/instance.php</code></p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nx">register_post_type</span><span class="p">(</span>
    <span class="s1">'sd_event'</span><span class="p">,</span> <span class="c1">// nom informatique unique de notre CPT,
</span>    <span class="k">array</span><span class="p">(</span>
        <span class="s1">'label'</span> <span class="o">=&gt;</span> <span class="s1">'Événements'</span><span class="p">,</span> <span class="c1">// nom humain de notre CPT, affiché dans l’administration,
</span>        <span class="s1">'public'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">// permet d’activer les interfaces de gestion de nos événements
</span>        <span class="s1">'has_archive'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">// permet d’activer la fonctionnalité page d’archive
</span>        <span class="s1">'supports'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'title'</span><span class="p">,</span>
            <span class="s1">'editor'</span><span class="p">,</span>
            <span class="s1">'thumbnail'</span><span class="p">,</span> <span class="c1">// permet d’associer une image à nos événements
</span>        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">);</span>
</code></pre>

<p>Un type de post personnalisé est un contenu. On veut découpler la définition de ce contenu
du thème pour que l’administrateur du site puisse changer de thème sans perdre son contenu.
On souhaite aussi éviter que l’administrateur puisse perdre son contenu en désactivant une extension (plugin)
par inadvertance. On va donc enregistrer notre type personnalisé dans un
<a href="https://codex.wordpress.org/Must_Use_Plugins"><code class="prettyprint">mu_plugin</code></a>
(plugin obligatoire, indispensable, toujours chargé par WordPress, inaccessible dans l’interface de gestion des plugins).</p>

<p>Pour créer un <code class="prettyprint">mu_plugin</code> on crée un dossier <code class="prettyprint">mu-plugins</code> dans le dossier <code class="prettyprint">wp-content</code>, donc à côté des
dossiers <code class="prettyprint">themes</code> et <code class="prettyprint">plugins</code>. Dans ce dossier, on place un fichier <code class="prettyprint">instance.php</code> avec le
code d’enregistrement du nouveau type de post (fonction
<a href="https://codex.wordpress.org/Function_Reference/register_post_type">register_post_type</a>).</p>

<p>Attention à distinguer le <em>nom informatique</em> utilisé par le système de WordPress, qui doit être
sans caractères spéciaux, sans espaces et unique, du <em>nom humain</em> affiché dans l’interface
d’administration. Comme le <em>nom informatique</em> doit être unique, on diminue les risques de collision
en le préfixant. Ici on utilise <em>sd_</em> soit les initiales de <em>Siècle Digital</em> suivi d’un « <em>_</em> »
(« underscore » ou « tiret bas » ou « blanc souligné » ou « tiret du 8 » pour les noobs
qui ne connaissent que Windows les pauvres).</p>

<p>À noter que le paramètre <code class="prettyprint">has_archive</code> permet de faire apparaître la page d’archive au niveau de
l’interface de gestion des menus (faire « View all » ou « Afficher tout » pour trouver ça).</p>

<aside class="warning">
    Pour que WordPress prenne bien en compte les nouvelles URL liées à notre
    nouveau type de contenu, il faut aller dans les Réglages des Permalinks
    et enregistrer la page, telle quelle. 
</aside>

<h3 id="création-des-templates">Création des templates</h3>

<blockquote>
<p>Base pour le template d’archive</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span> <span class="nx">get_header</span><span class="p">()</span> <span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="nx">do_action</span><span class="p">(</span><span class="s1">'sd_events_filters'</span><span class="p">)</span> <span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">while</span> <span class="p">(</span><span class="nx">have_posts</span><span class="p">())</span><span class="o">:</span> <span class="nx">the_post</span><span class="p">()</span> <span class="cp">?&gt;</span>
    <span class="nt">&lt;article&gt;</span>
        <span class="nt">&lt;h2&gt;</span><span class="cp">&lt;?php</span> <span class="nx">the_title</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="nt">&lt;/h2&gt;</span>
        <span class="nt">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">get_the_date</span><span class="p">(</span><span class="nx">get_option</span><span class="p">(</span><span class="s1">'date_format'</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;div&gt;</span><span class="cp">&lt;?php</span> <span class="nx">the_content</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/article&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endwhile</span> <span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="nx">get_footer</span><span class="p">()</span> <span class="cp">?&gt;</span>

</code></pre>

<blockquote>
<p>Base pour le template single</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span> <span class="nx">get_header</span><span class="p">()</span> <span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="nx">the_post</span><span class="p">()</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;h1&gt;</span><span class="cp">&lt;?php</span> <span class="nx">the_title</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">get_the_date</span><span class="p">(</span><span class="nx">get_option</span><span class="p">(</span><span class="s1">'date_format'</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;div&gt;</span><span class="cp">&lt;?php</span> <span class="nx">the_content</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="cp">&lt;?php</span> <span class="nx">get_footer</span><span class="p">()</span> <span class="cp">?&gt;</span>
</code></pre>

<p>Utiliser la <a href="https://wphierarchy.com/">hiérarchie des templates de WordPress</a> et créer
les bons templates dans le thème enfant :</p>

<ul>
<li>Un template prenant en charge l’affichage de la liste des événements (donc entrée <em>Archive</em>)</li>
<li>Un template prenant en charge l’affichage d’un événement tout seul (donc entrée <em>Singular Page</em>)</li>
</ul>

<p>On ajoute, au début du template d’archive, un <em>hook</em> d’action pour qu’un plugin puisse plus tard
insérer ici le formulaire de recherche / filtrage des événements : <code class="prettyprint">do_action(&#39;sd_events_filters&#39;)</code>.</p>

<p>Du code tiers — plugin ou mu-plugin — pourra alors exécuter ce que souhaité en
enregistrant une fonction sur ce <em>hook</em> avec <code class="prettyprint">add_action(&#39;sd_events_filters&#39;, function () {})</code>.</p>

<h2 id="affichage-d’une-date-personnalisée">Affichage d’une date personnalisée</h2>

<blockquote>
<p>Dans functions.php pour la période</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="sd">/**
 * Retourne la période Mois, Année d’une date ACF.
 * Fonctionne si le format d’enregistrement ACF est yymmdd.
 * @param string $name Nom du champ ACF
 */</span>
<span class="k">function</span> <span class="nf">sd_get_period</span><span class="p">(</span><span class="nv">$name</span><span class="p">){</span>
    <span class="nv">$date</span> <span class="o">=</span> <span class="nx">DateTime</span><span class="o">::</span><span class="na">createFromFormat</span><span class="p">(</span><span class="s1">'Ymd'</span><span class="p">,</span> <span class="nx">get_field</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$date</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$period</span> <span class="o">=</span> <span class="nv">$date</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span><span class="s1">'F Y'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$period</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$period</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<blockquote>
<p>Toujours dans functions.php pour un format spécifique</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">sd_get_acf_date</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$format</span> <span class="o">=</span> <span class="s1">'d F Y'</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$date</span> <span class="o">=</span> <span class="nx">DateTime</span><span class="o">::</span><span class="na">createFromFormat</span><span class="p">(</span><span class="s1">'Ymd'</span><span class="p">,</span> <span class="nx">get_field</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$date</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$formatted</span> <span class="o">=</span> <span class="nv">$date</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span><span class="nv">$format</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$formatted</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$formatted</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<blockquote>
<p>Dans le template</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span> <span class="nv">$period</span> <span class="o">=</span> <span class="nx">sd_get_period</span><span class="p">(</span><span class="s1">'date_begin'</span><span class="p">)</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$period</span> <span class="cp">?&gt;</span><span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;span&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">sd_get_acf_date</span><span class="p">(</span><span class="s1">'date_begin'</span><span class="p">,</span> <span class="s1">'d m Y'</span><span class="p">)</span> <span class="cp">?&gt;</span>
</code></pre>

<p>La date de survenue des événements est affichée entre les événements dans la liste
des événements sur le modèle Siècle Digital.</p>

<p>Pour pouvoir formatter simplement cette date dans le format souhaité,
on va utiliser un hook sur la valeur de date retournée par ACF
pour la convertir en objet <code class="prettyprint">DateTime</code> PHP.</p>

<p>On peut ensuite utiliser le second bloc de code dans le template pour
obtenir la valeur, comme avant, et la formatter comme voulu.</p>

<p>À ce stade, la période (par exemple « Novembre 2017 ») va apparaître
entre chaque article. Je vous laisse chercher comment n’afficher cette
période que lorsqu’elle change.</p>

<p>Pour formatter la date d’un champ ACF, on utilise la fonction
<code class="prettyprint">sd_get_acf_date</code>. Elle prend en premier paramètre le nom du champ,
en second paramètre le format
(voir <a href="http://php.net/manual/fr/function.date.php">PHP <code class="prettyprint">date()</code></a>);</p>

<h2 id="modifier-l’ordre-des-événements">Modifier l’ordre des événements</h2>

<blockquote>
<p>Dans <code class="prettyprint">functions.php</code> (question relative au thème, à l’affichage)</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>

<span class="nx">add_action</span><span class="p">(</span><span class="s1">'pre_get_posts'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// attention, vérifier qu’on est sur la bonne requête avant toute autre opération !
</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$query</span><span class="o">-&gt;</span><span class="na">is_main_query</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<p>Par défaut, WordPress affiche les événements par ordre décroissant de date de création.
Nous souhaitons faire afficher ces événements par ordre croissant de champ
ACF (le champ ACF dans lequel nous stockons la date de début).</p>

<p>Pour modifier l’ordre d’affichage, il faut modifier la requête WordPress qui
va chercher les événements dans la base de données. Pour modifier cette
requête, WordPress nous offre un <em>hook</em> parfait : 
<a href="https://codex.wordpress.org/Plugin_API/Action_Reference/pre_get_posts"><code class="prettyprint">pre_get_posts</code></a>
dont la documentation est d’une grande aide.</p>

<p>Attention, avant de modifier la requête, de vérifier qu’on modifie la bonne.
Pour information, le <em>hook</em> <code class="prettyprint">pre_get_posts</code> est appelé pour toutes les requêtes
de contenu de WordPress, donc pour la requête principale, mais aussi pour les
requêtes supplémentaires (<em>sidebar</em> par exemple) et les requêtes de l’administration.</p>

<p>On peut évacuer les cas non désirés en suivant le modèle de l’exemple de droite :
test et <code class="prettyprint">return</code> si le résultat ne convient pas. Le mot clé <code class="prettyprint">return</code> fait
ressortir de la fonction et la suite de la fonction n’est pas exécutée.</p>

<p>Toutes les requêtes de WordPress sont représentées par un objet de type
<a href="https://codex.wordpress.org/Class_Reference/WP_Query"><code class="prettyprint">WP_Query</code></a>. La
documentation de cet objet, de ses <em>propriétés</em> et de ses <em>méthodes</em>
devrait suffire pour modifier l’ordre des événements. Un indice quand même,
il va falloir ajouter une <a href="https://codex.wordpress.org/Class_Reference/WP_Meta_Query"><code class="prettyprint">WP_Meta_Query</code></a>
à l’objet <code class="prettyprint">WP_Query</code> pour activer l’ordre sur un champ meta (<em>custom field</em>).
ACF se contente de fournir une interface d’édition au système de champs meta. Les
noms de vos champs ACF sont également les noms de vos champs meta,
utilisables dans une <code class="prettyprint">WP_Meta_Query</code>.</p>

<aside class="notice">
    Les indications qui précèdent sont truffées de mots clés qui donnent
    de bons résultats dans un moteur de recherche.
</aside>

<h2 id="ajouter-un-lien-sous-l’extrait-de-post">Ajouter un lien sous l’extrait de post</h2>

<blockquote>
<p>Dans <code class="prettyprint">functions.php</code></p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nx">add_filter</span><span class="p">(</span><span class="s1">'the_excerpt'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$exercpt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$exercpt</span> <span class="o">=</span> <span class="nv">$exercpt</span> <span class="o">.</span> <span class="s1">'&lt;a class="more-link" href="'</span><span class="o">.</span> <span class="nx">get_the_permalink</span><span class="p">()</span> <span class="o">.</span><span class="s1">'"&gt;Lire plus&lt;/a&gt;'</span><span class="p">;</span>
    <span class="k">return</span> <span class="nv">$exercpt</span><span class="p">;</span>
<span class="p">});</span>
</code></pre>

<p>On se branche sur le <em>hook</em> <code class="prettyprint">the_excerpt</code> et on ajoute
le lien à la valeur transmise (on modifie cette valeur,
l’extrait du post, grâce au <em>hook</em> de type filtre).</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
